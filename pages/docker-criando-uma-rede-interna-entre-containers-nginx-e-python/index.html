<!doctype html>
<html lang="pt-br">
  <head>
    
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-W6FCC8W');</script>
<!-- End Google Tag Manager -->

    <meta charset="utf-8">
    <title>Docker: criando uma rede interna entre containers NGINX e python | dgmike</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/default.min.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/static/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16x16.png">
<link rel="manifest" href="/static/site.webmanifest">
  </head>
  <body class="page">
    
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W6FCC8W"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    <div class="wrapper">
      <header>
        <h1>
          <a href="" title="dgmike">
            dgmike
          </a>
        </h1>
        <p>
          Venha comigo descobrir esse mundo de tecnologia.
        </p>
      </header>
      <article>
        <h2>Docker: criando uma rede interna entre containers NGINX e python</h2>
        <p class="published_at">
          Publicado em
          <time datetime="2022-01-17T15:16:37.970Z">17/01/2022</time>
        </p>
        <figure>
          <img src="https://imgix.cosmicjs.com/e06e1630-779b-11ec-bfef-718573fe8f91-docker-networking.png" alt="" />
          <figcaption>Conhecendo como funciona o sistema de redes do docker. Neste artigo, demonstro como criar e utilizar uma rede com docker puro.</figcaption>
        </figure>
        <p>Antes de mais nada, este artigo considera que voc&ecirc; j&aacute; tenha o <code>docker</code> instalado e que voc&ecirc; tenha algum conhecimento de terminal/bash para conseguir executar os passos abaixo. Pode ser executado em Windows, Mac ou Linux com suas devidas adapta&ccedil;&otilde;es. Neste artigo estou utilizando <code>ubuntu 20.04.2 LTS</code>. Se um comando estiver rodando em um terminal (como um cont&ecirc;iner), abra um novo terminal para executar o outro comando, simples
assim.</p><h2 id="criando-um-servidor-python">Criando um servidor python</h2><p>Vamos criar um programa em <code>python</code> para servir uma p&aacute;gina din&acirc;mica. Crie uma pasta com o nome <code>python</code> e crie um arquivo com o nome <code>main.py</code> dentro delac om o seguinte conte&uacute;do (n&atilde;o vou entrar no m&eacute;rito de como voc&ecirc; far&aacute; isso, utilize seu <a href="https://www.nano-editor.org/">editor de texto de prefer&ecirc;ncia</a>):</p><pre class=" language-python"><code class=" language-python"><span class="token keyword">import</span> osfrom http <span class="token keyword">import</span> HTTPStatus<span class="token punctuation">,</span> serverimport socketserverfrom textwrap <span class="token keyword">import</span> dedentclass Server<span class="token punctuation">(</span>server<span class="token punctuation">.</span>SimpleHTTPRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">do_GET</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>HTTPStatus<span class="token punctuation">.</span>OK<span class="token punctuation">.</span>value<span class="token punctuation">,</span> HTTPStatus<span class="token punctuation">.</span>OK<span class="token punctuation">.</span>phrase<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send_header<span class="token punctuation">(</span><span class="token string">&#39;Content-Type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;text/html&#39;</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>bytes<span class="token punctuation">(</span>dedent<span class="token punctuation">(</span><span class="token triple-quoted-string string">&quot;&quot;&quot;            &lt;doctype html&gt;            &lt;html&gt;                &lt;head&gt;                    &lt;meta charset=&quot;utf-8&quot;&gt;                    &lt;title&gt;Exemplo&lt;/title&gt;                &lt;/head&gt;                &lt;body&gt;                    &lt;h1&gt;Python&lt;/h1&gt;                    &lt;p&gt;&lt;code&gt;1 + 1 = {}&lt;/code&gt;&lt;/p&gt;                    &lt;img src=&quot;/images/carnaval.gif&quot; alt=&quot;Imagem de festa de carnaval&quot; /&gt;                &lt;/body&gt;            &lt;/html&gt;        &quot;&quot;&quot;</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">serve_forever</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">:</span>        socketserver<span class="token punctuation">.</span>TCPServer<span class="token punctuation">.</span>allow_reuse_address <span class="token operator">=</span> <span class="token boolean">True</span>        socketserver<span class="token punctuation">.</span>TCPServer<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Server<span class="token punctuation">)</span><span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>    PORT <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;PORT&#39;</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token number">8000</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Serving on port %s&quot;</span> <span class="token operator">%</span> PORT<span class="token punctuation">)</span>    Server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span>PORT<span class="token punctuation">)</span></code></pre><p>Perceba que foi colocada uma imagem de carnaval ali que n&atilde;o existe. Voltaremosnela a qualquer momento, ela n&atilde;o deve funcionar nesse momento mesmo.</p><p>Agora, rode um container montando o volume do container apontando para essapasta expondo a porta <code>8000</code> e executando o comando <code>python</code> sobre esse arquivo:</p><pre><code class="nohighlight">docker run --rm -ti -v $(pwd)/python:/app -p 8000:8000 --name dinamico python:3-alpine python /app/main.py
</code></pre><p>Com isso, ser&aacute; poss&iacute;vel acessar o servidor <code>python</code> atrav&eacute;s do endere&ccedil;o<code><a href="http://localhost:8000">http://localhost:8000</a></code>. Veja que a p&aacute;gina foi acessada, que o conte&uacute;do &eacute; oresultado do <code>1 + 1</code> que foi processado pelo <code>python</code> e a imagem de carnavaln&atilde;o foi trazida.</p><h2 id="criando-um-servidor-estático-nginx">Criando um servidor est&aacute;tico (nginx)</h2><p>Vamos criar uma pasta e colocar dentro dela uma imagem de carnaval (sim, aquela que falamos l&aacute; no servidor python).</p><p>Crie uma pasta com o nome <code>public</code> e coloque uma imagem bem bonita do carnaval.Voc&ecirc; pode usar qualquer imagem vinda do<a href="https://www.google.com/search?q=carnaval+gif&tbm=isch">google images</a>.</p><p>Levante um servidor de arquivos est&aacute;ticos utilizando a imagem <code>nginx:alpine</code> esirva os arquivos que est&atilde;o na pasta <code>public</code> na porta <code>9000</code>.</p><pre><code class="nohighlight">docker run --rm -ti -v $(pwd)/public:/usr/share/nginx/html -p 9000:80 --name estaticos nginx:alpine
</code></pre><p>Experimente acessar a seguinte rota no seu navegador:<code>http://localhost:9000/carnaval.gif</code>.</p><h2 id="o-problema">O problema</h2><p>At&eacute; este momento, nenhum container consegue &ldquo;enxergar&rdquo; o outro pelo seu<em>hostname</em>, somente pelo IP de cada um. Isto acontece porque eles n&atilde;o est&atilde;oconectados no mesmo <em>network</em>. Experimente acessar de dentro
dos containers.</p><p>Primeiro, descubra o IP de cada conteiner.</p><pre><code class="nohighlight">docker inspect -f &#39;&#39; estaticos
172.17.0.3
docker inspect -f &#39;&#39; dinamico
172.17.0.2
</code></pre><p>Com esses IPs em m&atilde;o, entre em um container e fa&ccedil;a um ping no IP do outrocontainer.</p><pre><code class="nohighlight">docker exec -ti dinamico ash
# /
</code></pre><p>Ao exibir esse <code>prompt</code> com os caracteres <code># /</code> voc&ecirc; estar&aacute; dentro do terminal<code>ash</code> do container. Nele, fa&ccedil;a um <code>ping</code> no outro cont&ecirc;iner. Utilize o atributo<code>-c 2</code> para que sejam feitas apenas 2 itera&ccedil;&otilde;es.</p><pre><code class="nohighlight"># / ping -c 2 172.17.0.3
PING 172.17.0.3 (172.17.0.3): 56 data bytes
64 bytes from 172.17.0.3: seq=0 ttl=64 time=0.191 ms
64 bytes from 172.17.0.3: seq=1 ttl=64 time=0.121 ms

--- 172.17.0.3 ping statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max = 0.121/0.156/0.191 ms
</code></pre><p>Tente acessar um <em>hostname</em> externo, ver&aacute; que ser&aacute; poss&iacute;vel:</p><pre><code class="nohighlight">/ # ping -c 2 google.com
PING google.com (172.217.29.110): 56 data bytes
64 bytes from 172.217.29.110: seq=0 ttl=254 time=14.828 ms
64 bytes from 172.217.29.110: seq=1 ttl=254 time=11.973 ms

--- google.com ping statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max = 11.973/13.400/14.828 ms
</code></pre><p>Agora, ao tentar acessar usando o <code>hostname</code> n&atilde;o ser&aacute; poss&iacute;vel:</p><pre><code class="nohighlight">/ # ping -c 2 estaticos
ping: bad address &#39;estaticos&#39;
</code></pre><p>Para sair do cont&ecirc;iner, use o comando <code>exit</code>. Isto trat&aacute; voc&ecirc; de volta ao seu<code>prompt</code> de comando normal.</p><pre><code class="nohighlight">/ # exit
</code></pre><h2 id="criando-uma-ponte-entre-nós">Criando uma ponte entre n&oacute;s</h2><p>Para criar a conex&atilde;o entre os cont&ecirc;ineres de forma que um consiga acessar o<em>hostname</em> do outro crie uma network do tipo <em>bridge</em>, ou seja, do tipo<em>user defined</em>. Assim os <em>containers</em> poder&atilde;o se comunicar de forma simples.</p><pre><code class="nohighlight">docker network create --driver bridge rede-maneira
</code></pre><p>Para verificar que a rede foi criada, utilize o comando <code>network ls</code>.</p><pre><code class="nohighlight">docker network ls
NETWORK ID     NAME         DRIVER    SCOPE
ea6f9892c87c   bridge       bridge    local
374b6a5a3dc7   host         host      local
293f617510fd   none         null      local
e201b67bf15b   rede-massa   bridge    local
</code></pre><p>Conecte-os utilizando o comando <code>network connect [rede] [container]</code>.</p><pre><code class="nohighlight">docker network connect rede-massa dinamico 
docker network connect rede-massa estaticos
</code></pre><p>Para verificar se eles est&atilde;o atrelados, utilize o <code>network inspect [rede]</code> paraverificar.</p><pre><code class="nohighlight">docker network inspect rede-massa
</code></pre><pre class=" language-json"><code class=" language-json"><span class="token punctuation">[</span>    <span class="token punctuation">{</span>        <span class="token property">&quot;Name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rede-massa&quot;</span><span class="token punctuation">,</span>        <span class="token property">&quot;Id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e201b67bf15bdc385b43522da4d1e9358e68c4b0e5eed0542232e1e7d86b8574&quot;</span><span class="token punctuation">,</span>        <span class="token property">&quot;Created&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-13T00:24:30.615556773-03:00&quot;</span><span class="token punctuation">,</span>        <span class="token property">&quot;Scope&quot;</span><span class="token operator">:</span> <span class="token string">&quot;local&quot;</span><span class="token punctuation">,</span>        <span class="token property">&quot;Driver&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bridge&quot;</span><span class="token punctuation">,</span>        <span class="token property">&quot;EnableIPv6&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>        <span class="token property">&quot;IPAM&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token property">&quot;Driver&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>            <span class="token property">&quot;Options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>            <span class="token property">&quot;Config&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>                <span class="token punctuation">{</span>                    <span class="token property">&quot;Subnet&quot;</span><span class="token operator">:</span> <span class="token string">&quot;172.20.0.0/16&quot;</span><span class="token punctuation">,</span>                    <span class="token property">&quot;Gateway&quot;</span><span class="token operator">:</span> <span class="token string">&quot;172.20.0.1&quot;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">]</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token property">&quot;Internal&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>        <span class="token property">&quot;Attachable&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>        <span class="token property">&quot;Ingress&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>        <span class="token property">&quot;ConfigFrom&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token property">&quot;Network&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token property">&quot;ConfigOnly&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>        <span class="token property">&quot;Containers&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token property">&quot;0db152ec91ada8675a94b4f318c3ee4eb7d540e2ff55d925c688fcd7b9e7cdcb&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                <span class="token property">&quot;Name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;estaticos&quot;</span><span class="token punctuation">,</span>                <span class="token property">&quot;EndpointID&quot;</span><span class="token operator">:</span> <span class="token string">&quot;9be41271013f4df28c64399513bf3eb26a44b9fe46973ab4d7aec949d712c720&quot;</span><span class="token punctuation">,</span>                <span class="token property">&quot;MacAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;00:00:00:00:00:00&quot;</span><span class="token punctuation">,</span>                <span class="token property">&quot;IPv4Address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;172.20.0.3/16&quot;</span><span class="token punctuation">,</span>                <span class="token property">&quot;IPv6Address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>            <span class="token punctuation">}</span><span class="token punctuation">,</span>            <span class="token property">&quot;cc275ab619c92949bca71e9e04f8e79b4a4e0d8abbfc820818e22e8aed2250de&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                <span class="token property">&quot;Name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dinamico&quot;</span><span class="token punctuation">,</span>                <span class="token property">&quot;EndpointID&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3e0e9ccf570deb8015b4bad7d8d17527164a94ea2179bfa9a40923e700770b6f&quot;</span><span class="token punctuation">,</span>                <span class="token property">&quot;MacAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;00:00:00:00:00:00&quot;</span><span class="token punctuation">,</span>                <span class="token property">&quot;IPv4Address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;172.20.0.2/16&quot;</span><span class="token punctuation">,</span>                <span class="token property">&quot;IPv6Address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token property">&quot;Options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token property">&quot;Labels&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">]</span></code></pre><p>Tente acessar novamente um cont&ecirc;iner de dentro do outro:</p><pre><code class="nohighlight">docker exec -ti dinamico
# / ping -c 2 estaticos
PING 172.17.0.3 (172.17.0.3): 56 data bytes
64 bytes from 172.17.0.3: seq=0 ttl=64 time=0.191 ms
64 bytes from 172.17.0.3: seq=1 ttl=64 time=0.121 ms

--- 172.17.0.3 ping statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max = 0.121/0.156/0.191 ms
</code></pre><p>Sucesso! Pode sair do container com o comando <code>exit</code>.</p><h2 id="criando-um-proxy-para-mapear-as-rotas">Criando um proxy para mapear as rotas</h2><p>Por &uacute;ltimo, vamos criar um servidor &ldquo;proxy&rdquo; utilizando a imagem <code>nginx:alpine</code>que ir&aacute; conectar os dois servidores e redirecionar cada requisi&ccedil;&atilde;o para seudevido lugar.</p><p>Crie uma pasta chamada <code>proxy</code> e crie um arquivo de configura&ccedil;&atilde;o do servidor<code>nginx</code> para mapear as rotas dos servidores utilizando o comando <code>proxy_pass</code>para informar que ao tentar acessar a rota <code>/</code>deve
enviar para o servidor<code>dinamico</code> pela porta <code>8000</code> e ao acessar a rota <code>/images</code> deve enviar para oservidor <code>estaticos</code> na porta <code>80</code>. Aproveitando, utilizamos o comando <code>rewrite</code>para remover a &ldquo;pasta&rdquo; <code>/images</code> da rota, deixando transparente para o cont&ecirc;inerde arquivos est&aacute;ticos (saber express&otilde;es regulares sempre ajuda muito).</p><pre class=" language-nginx"><code class=" language-nginx">worker_processes 1;http {    server {        listen 80;        location / {            proxy_pass http://dinamico:8000;        }        location /images {            rewrite /images/([^/]+) /$1 break;            proxy_pass http://estaticos:80;        }    }}events {    worker_connections  1024;}</code></pre><p>Utilize a pasta <code>proxy</code> para fazer a configura&ccedil;&atilde;o do <code>nginx</code>. Aproveite para j&aacute;conectar o container na rede no momento de cria&ccedil;&atilde;o (com o atributo <code>--network</code>),assim pode-se economizar
linhas de comando.</p><p>Vamos expor a porta <code>3000</code> para conseguir acessar o proxy.</p><pre><code class="nohighlight">docker run --rm -ti -v $(pwd)/proxy/nginx.conf:/etc/nginx/nginx.conf --network rede-massa -p 3000:80 --name proxy nginx:alpine
</code></pre><p>Por fim, tente acessar o proxy pela url <code>http://localhost:3000/</code>, e voc&ecirc; ver&aacute; a p&aacute;gina escrita em <code>python</code> e a imagem distribu&iacute;da pelo <code>nginx</code>, todas dispon&iacute;veis pelo <code>proxy</code>.</p><p>Basicamente, foi isto o que foi feito:</p><pre><code class="nohighlight">                                       .------------------------- rede-massa ---------------------------.
                                       |                                                                |
                                       |    .--------.                                    .----------.  |
(internet) -- http://localhost:3000 ---+--&gt; | proxy  | --- / --&gt; http://dinamico:8000 --&gt; | dinamico |  |
                                       |    &#39;--------&#39;                                    &#39;----------&#39;  |
                                       |       |                                                        |
                                       |       |                                        .-----------.   |
                                       |       &#39;--- /images --&gt; http://estaticos:80 --&gt; | estaticos |   |
                                       |                                                &#39;-----------&#39;   |
                                       &#39;----------------------------------------------------------------&#39;
</code></pre><p>Desta forma, apenas o <code>proxy</code> precisa estar com a porta exposta.</p><p>Para &ldquo;destruir&rdquo; tudo execute a sequencia abaixo, n&atilde;o vou entrar em detalhes poisos comandos s&atilde;o auto explicativos:</p><pre><code class="nohighlight"># pare os cont&ecirc;ineres
docker stop estaticos
docker stop dinamico
docker stop proxy
# remova os cont&ecirc;ineres
docker rm estaticos
docker rm dinamico
docker rm proxy
# remova a rede
docker network rm rede-massa
# caso queira, remova as imagens (eu costumo deixar para n&atilde;o precisar baixar novamente no futuro)
docker rmi nginx:alpine
docker rmi python:3-alpine
</code></pre><p>Verifique se tudo foi removido:</p><pre><code class="nohighlight">docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES

docker network ls
NETWORK ID     NAME      DRIVER    SCOPE
ea6f9892c87c   bridge    bridge    local
374b6a5a3dc7   host      host      local
293f617510fd   none      null      local
</code></pre><p>Tente criar tudo novamente s&oacute; que agora s&oacute; expondo somente a porta do <code>proxy</code>.</p><hr><p>Alguns comandos para ajudar:</p><pre><code class="nohighlight"># container
docker ps                                    # lista os containers
docker run [imagem]                          # roda um container
docker stop [container]                      # para um container
docker inspect [container]                   # verifica informa&ccedil;&otilde;es do container
docker exec [container] [comando]            # executa um comando no container
docker rm [container]                        # remove um container (parado)

# imagens
docker pull [image]                          # baixa uma imagem do hub.docker.com
docker rmi [image]                           # apaga uma imagem do cache de sua m&aacute;quina

# network
docker network create --driver bridge [rede] # cria uma rede do tipo bridge
docker network connect [rede] [container]    # conecta o container
docker network disconnect [rede] [container] # desconectar o container
docker network inspect [rede]                # v&ecirc; detalhes de uma rede
docker network rm [rede]                     # apaga uma rede
</code></pre><p>Alguns atributos do comando <code>docker run</code>:</p><pre><code class="nohighlight">docker run
    -i -t                                  # habilita poderem de intera&ccedil;&atilde;o de Input pelo TTY (terminal)
    --rm                                   # remove o container assim que ele for finalizado
    -p [porta_externa]:[porta_interna]     # exp&otilde;e uma porta para acesso
    -v [pasta]:[pasta_do_container]        # monta/mapeia uma pasta dentro do container
    --network [rede]                       # conecta o container a uma rede
    --name [nome]                          # nome de f&aacute;cil acesso ao container
    [imagem]                               # imagem que ser&aacute; executada
    [comando]                              # comando dentro da imagem a ser executado
</code></pre><hr><p>Referencias:</p><ul><li>https://docs.docker.com/network/bridge/</li><li>https://docs.docker.com/network/network-tutorial-standalone/</li><li>https://hub.docker.com/_/nginx</li><li>https://hub.docker.com/_/python</li><li>https://pythonbasics.org/webserver/</li><li>https://stackoverflow.com/a/25529620</li><li>https://docs.python.org/3/library/http.server.html#module-http.server</li><li>http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_pass</li><li>http://nginx.org/en/docs/beginners_guide.html#conf_structure</li><li>https://gist.github.com/nishantmodak/d08aae033775cb1a0f8a</li><li>https://docs.docker.com/engine/reference/commandline/run/</li><li>https://docs.docker.com/engine/reference/commandline/network/</li></ul>

        
        <div class="tags">
          <p>Tags:</p>
          <ul>
            
            <li>Docker</li>
            
            <li>Tutoriais</li>
            
            <li>Python</li>
            
          </ul>
        </div>
        

        <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
      this.page.url = 'https://www.dgmike.com.br/pages/docker-criando-uma-rede-interna-entre-containers-nginx-e-python/';
      this.page.identifier = 'page--docker-criando-uma-rede-interna-entre-containers-nginx-e-python';
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://dgmike.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

      </article>
          <aside>
      <div class="site-author">
        <h2>Michael Castillo Granados</h2>
        <img src="https://gravatar.com/avatar/8124dfabd75efe3e286d448f8eaa77f6" title="Michael Castillo Granados" alt="Michael Castillo Granados's photo" />
        <p>Sou uma pessoa apaixonada por desenvolvimento web. Formado em design gráfico, já atuei em diversos campos da tecnologia como design, desenvolvimento, infra, publicação de conteúdo, devops, inovação e liderança técnica.</p>
      </div>
      
      <ul>
        <li>
          <a href="/pages/docker-criando-uma-rede-interna-entre-containers-nginx-e-python/" title="Docker: criando uma rede interna entre containers NGINX e python">
            <p class="title">Docker: criando uma rede interna entre containers NGINX e python</p>
            <p class="headline">
              Conhecendo como funciona o sistema de redes do docker. Neste artigo, demonstro como criar e utilizar uma rede com docker puro.
            </p>
            <p class="published_at">
              Publicado em
              <time datetime="2022-01-17T15:16:37.970Z">17/01/2022</time>
            </p>
          </a>
        </li>
        <li>
          <a href="/pages/javascript-uma-linguagem-maravilhosa/" title="Javascript: uma linguagem maravilhosa!">
            <p class="title">Javascript: uma linguagem maravilhosa!</p>
            <p class="headline">
              Uma de minhas linguagens favoritas é o Javascript. Além de ser versátil e robusta, a linguagem não precisa de muito para você começar a ser produtivo.
            </p>
            <p class="published_at">
              Publicado em
              <time datetime="2022-01-17T19:37:41.719Z">17/01/2022</time>
            </p>
          </a>
        </li>
        <li>
          <a href="/pages/o-comeco-de-tudo/" title="O começo de tudo">
            <p class="title">O começo de tudo</p>
            <p class="headline">
              Minha vida como desenvolvedor de software começou mesmo antes de ter um computador. Uma história nostálgica dos meus primeiros contatos com essa máquina que hoje provém meus sustentos.
            </p>
            <p class="published_at">
              Publicado em
              <time datetime="2022-01-17T13:33:09.660Z">17/01/2022</time>
            </p>
          </a>
        </li>
      </ul>
      
    </aside>

    </div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
  </body>
</html>
